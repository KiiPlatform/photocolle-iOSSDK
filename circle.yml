machine:
  xcode:
    version: "7.2"

dependencies:
  pre:
    - brew install ios-sim
  post:
    # lint pod
    - pod spec lint --fail-fast
    # Build sdk
    - cd photocolle-sdk; make framework
    # Copy sdk to artifacts
    - cp -fr photocolle-sdk/dist $CIRCLE_ARTIFACTS
    # Build docs
    - cd photocolle-sdk; make doc
    # Copy docs to artifacts
    - cp -fr photocolle-sdk/target/apiDoc $CIRCLE_ARTIFACTS

test:
  override:
    # run small tests
    - cd photocolle-sdk; make test
    - cp photocolle-sdk/test-results/*.xml $CIRCLE_TEST_REPORTS/
